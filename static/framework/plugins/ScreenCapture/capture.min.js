function rgb2value(a,b,c){return a|b<<8|c<<16}function onpluginLoaded(){captureObjSelf.pluginLoaded()}function NiuniuCaptureObject(){var a=this;captureObjSelf=this,this.PenSize=2,this.DrawType=0,this.TrackColor=rgb2value(255,0,0),this.EditBorderColor=rgb2value(255,0,0),this.Transparent=240,this.WindowAware=1,this.MosaicType=1,this.SaveName="测试保存",this.MagnifierLogoText="测试截图",this.WatermarkPictureType=3,this.WatermarkPicturePath="",this.WatermartTextType=1,this.WatermartTextValue="",this.NiuniuAuthKey="",this.ToolTipText="",this.FinishedCallback=null,this.PluginLoadedCallback=null,this.IsNeedCrx=function(){var b=a.IsRealChrome(),c=a.GetChromeMainVersion();return!!(b&&c>41)},this.LoadPlugin=function(){var a=$("#capturecontainer");a.length<1&&($("body").append('<div id="capturecontainer" style="height:0px;width:0px;"></div>'),a=$("#capturecontainer")),a.html(""),a.html('<object id="niuniuCapture" type="application/x-niuniuwebcapture" width="0" height="0"><param name="onload" value="onpluginLoaded" /></object>')},this.niuniuCapture=function(){return document.getElementById("niuniuCapture")},this.addEvent=function(a,b,c){a.attachEvent?a.attachEvent("on"+b,c):a.addEventListener(b,c,!1)},this.pluginValid=function(){try{if(a.niuniuCapture().valid)return!0}catch(b){}return!1},this.OnCaptureFinished=function(b,c,d,e,f,g){a.OnCaptureFinishedEx(1,b,c,d,e,"",f,g)},this.OnCaptureFinishedEx=function(b,c,d,e,f,g,h,i){null!=a.FinishedCallback?a.FinishedCallback(b,c,d,e,f,g,h,i):alert("截图完成的事件未绑定，将不能对图片进行处理，请指定FinishedCallback回调函数")},this.pluginLoaded=function(){return a.pluginValid()?(a.niuniuCapture().InitCapture(a.NiuniuAuthKey),a.niuniuCapture().InitParam(emPensize,a.PenSize),a.niuniuCapture().InitParam(emDrawType,a.DrawType),a.niuniuCapture().InitParam(emTrackColor,a.TrackColor),a.niuniuCapture().InitParam(emEditBorderColor,a.EditBorderColor),a.niuniuCapture().InitParam(emTransparent,a.Transparent),a.niuniuCapture().InitParam(emSetSaveName,a.SaveName),a.niuniuCapture().InitParam(emSetMagnifierLogoText,a.MagnifierLogoText),a.niuniuCapture().InitParam(emSetMosaicType,a.MosaicType),a.niuniuCapture().InitParam(emSetTooltipText,a.ToolTipText),a.addEvent(a.niuniuCapture(),"CaptureFinishedEx",a.OnCaptureFinishedEx),a.addEvent(a.niuniuCapture(),"CaptureFinished",a.OnCaptureFinished),void(null!=a.PluginLoadedCallback&&a.PluginLoadedCallback(!0))):(null!=a.PluginLoadedCallback&&a.PluginLoadedCallback(!1),!1)},this.SetWatermarkPicture=function(b){a.WatermarkPicturePath=b,a.pluginValid()&&a.niuniuCapture().InitParam(emSetWatermarkPicturePath,a.WatermarkPicturePath)},this.SetWatermarkText=function(b){a.WatermarkTextValue=b,a.pluginValid()&&a.niuniuCapture().InitParam(emSetWatermarkTextValue,a.WatermarkTextValue)},this.SavePicture=function(b){a.pluginValid()&&a.niuniuCapture().SavePicture(b)},this.GetCursorPosition=function(){if(a.pluginValid()){var b=a.niuniuCapture().GetCursorPosition();return b}return""},this.NewCaptureParamObject=function(b,c,d,e,f,g,h){var i=new Object;return i.IsGBK=0,i.AuthKey=a.NiuniuAuthKey,i.Pensize=a.PenSize,i.DrawType=a.DrawType,i.TrackColor=a.TrackColor,i.EditBorderColor=a.EditBorderColor,i.Transparent=a.Transparent,i.SetSaveName=a.SaveName,i.SetMagnifierLogoText=a.MagnifierLogoText,i.SetWatermarkPictureType=3,i.SetWatermarkPicturePath=a.WatermarkPicturePath,i.SetWatermarkTextType=1,i.SetWatermarkTextValue=a.WatermarkTextValue,i.MosaicType=a.MosaicType,i.DefaultPath=b,i.HideCurrentWindow=c,i.AutoCaptureFlag=d,i.x=e,i.y=f,i.Width=g,i.Height=h,i},this.BindChromeCallback=function(){document.addEventListener("NiuniuCaptureEventCallBack",function(b){var c=b.detail;c.Result==-2&&a.OnCaptureFinishedEx(-1,0,0,0,0,"","",""),c.Result!=-1?a.OnCaptureFinishedEx(c.Type,c.x,c.y,c.Width,c.Height,c.Info,c.Content,c.LocalPath):alert("出错："+c.Info)})},this.IsRealChrome=function(){try{var a=window.navigator.userAgent.toLowerCase(),b=a.indexOf("qqbrowser")!=-1;if(b)return!1;var c=a.indexOf("ubrowser")!=-1;if(c)return!1;var d=a.indexOf("chrome")!=-1;return!!(d&&chrome&&chrome.runtime)}catch(e){}return!1},this.GetChromeMainVersion=function(){var a=navigator.userAgent.toLowerCase(),b=""+(/chrome\/((\d|\.)+)/i.test(a)&&RegExp.$1);return"false"!=b?parseInt(b):0},this.DoCaptureForChrome=function(b,c,d,e,f,g,h){var i=a.NewCaptureParamObject(b,c,d,e,f,g,h);try{var j=JSON.stringify(i),k="NiuniuCaptureEvent",l=$("#"+k);if(l.length<1)return!1;var m=document.createEvent("CustomEvent");return m.initCustomEvent(k,!0,!1,j),document.dispatchEvent(m),!0}catch(n){}return!1},this.DoCapture=function(b,c,d,e,f,g,h){return a.IsNeedCrx()?a.DoCaptureForChrome(b,c,d,parseInt(e),parseInt(f),parseInt(g),parseInt(h)):!!a.pluginValid()&&(a.niuniuCapture().Capture(b,c,d,e,f,g,h),!0)},this.InitNiuniuCapture=function(){a.IsNeedCrx()?a.BindChromeCallback():a.LoadPlugin()}}var emPensize=1,emDrawType=2,emTrackColor=3,emEditBorderColor=4,emTransparent=5,emWindowAware=6,emSetSaveName=8,emSetMagnifierBkColor=9,emSetMagnifierLogoText=10,emSetWatermarkPictureType=20,emSetWatermarkPicturePath=21,emSetWatermarkTextType=22,emSetWatermarkTextValue=23,emSetMosaicType=24,emSetTooltipText=25,captureObjSelf=null;
//# sourceMappingURL=capture.min.js.map
/*! 康美网络医院 最后修改于： 2016-10-17 */